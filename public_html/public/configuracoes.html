<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Consignei - Painel</title>
    <link rel="icon" type="image/png" href="/img/favicon.png?v=1.2">
    
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    
    <style>
        :root { 
            --primary: #d4af37; --primary-hover: #b59025;
            --dark: #222; --light: #f4f6f8; --white: #ffffff;
            --gray: #888; --border: #e0e0e0;
            --success: #00b894; --danger: #e15b67; --info: #6c5ce7;
            --warning: #fdcb6e;
            --shadow: 0 4px 20px rgba(0,0,0,0.05);
            --radius: 16px;
            --overlay-bg: rgba(17, 17, 17, 0.55);
            --overlay-blur: 6px;
            --overlay-z: 4000;
        }
        * { box-sizing: border-box; outline: none; -webkit-tap-highlight-color: transparent; }
        html, body { width: 100%; }
        body { font-family: 'Poppins', sans-serif; margin: 0; display: flex; background: var(--light); height: 100vh; overflow: hidden; color: #444; }

        /* LOADING */
        #loadingOverlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(255,255,255,0.95); z-index: 9999;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
        }
        .spinner {
            width: 45px; height: 45px;
            border: 4px solid #f3f3f3; border-top-color: var(--primary);
            border-radius: 50%; animation: spin 0.8s ease-in-out infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* BOTÕES GERAIS */
        .btn { 
            padding: 12px 20px; border: none; border-radius: 12px; font-weight: 500; 
            cursor: pointer; transition: all 0.2s ease; font-size: 13px; 
            display: inline-flex; align-items: center; justify-content: center; gap: 8px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.05); text-decoration: none;
            white-space: nowrap; 
        }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .btn:active { transform: scale(0.96); }

        .btn-primary { background: var(--primary); color: var(--white); }
        .btn-primary:hover { background: var(--primary-hover); }
        .btn-secondary { background: #e9ecef; color: #444; }
        .btn-secondary:hover { background: #dee2e6; }
        .btn-danger { background: var(--danger); color: white; }
        .btn-danger:hover { background: #d63031; }
        .btn-success { background: var(--success); color: white; }
        .btn-success:hover { background: #009f7f; }

        .btn-dark-scan { background: #2d3436; color: white; border: none; }
        .btn-dark-scan:hover { background: #000; box-shadow: 0 4px 12px rgba(0,0,0,0.2); }

        .btn-icon { width: 40px; height: 40px; border-radius: 10px; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 20px; transition: 0.2s; background: transparent; color: #666; }
        .btn-icon:hover { background: #f0f0f0; transform: scale(1.1); }
        .btn-icon.edit:hover { background: #e8f0fe; color: #1a73e8; }
        .btn-icon.del:hover { background: #ffebeb; color: var(--danger); }
        .btn-icon.sell:hover { background: #e6fffa; color: var(--success); }
        .btn-icon.add-sub:hover { background: #f3f0ff; color: var(--info); }

        .actions-wrapper { display: flex; align-items: center; justify-content: center; gap: 6px; }
        .theme-opt { width: 40px; height: 40px; border-radius: 50%; cursor: pointer; border: 2px solid #eee; transition: 0.2s; }
        .theme-opt.selected { border-color: var(--primary); transform: scale(1.15); box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.2); }
        .theme-options { display: flex; flex-wrap: wrap; gap: 15px; align-items: center; }

        /* --- CUSTOMIZAÇÃO SWEETALERT (MODAIS PREMIUM) --- */
        .swal2-popup { 
            border-radius: 12px !important; padding: 30px !important; font-family: 'Poppins', sans-serif !important; 
            box-shadow: 0 10px 30px rgba(0,0,0,0.2) !important;
        }
        .swal2-title { font-size: 18px !important; color: var(--dark) !important; font-weight: 700 !important; margin-top: 10px !important; }
        .swal2-html-container { margin: 6px 0 0 !important; color: #666 !important; font-size: 13px !important; }
        .swal2-confirm {
            border-radius: 8px !important; padding: 10px 22px !important; font-weight: 600 !important; font-size: 13px !important; box-shadow: none !important;
            background: var(--dark) !important; color: #fff !important;
        }
        .swal2-cancel {
            border-radius: 8px !important; padding: 10px 22px !important; font-weight: 500 !important; font-size: 13px !important;
            background: #f1f2f6 !important; color: var(--dark) !important;
        }
        .swal2-input {
            border-radius: 8px !important; border: 1px solid #e0e0e0 !important; height: 45px !important; font-size: 13px !important;
            margin: 15px auto !important; width: 100% !important;
        }
        .swal2-input:focus { border-color: var(--primary) !important; box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.12) !important; }
        
        /* INPUTS GERAIS */
        input, select { padding: 12px; border: 1px solid var(--border); border-radius: 12px; font-size: 13px; width: 100%; background: #fdfdfd; color: #444; transition: 0.2s; }
        input:focus, select:focus { border-color: var(--primary); background: #fff; box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.1); }

        input[type=number]::-webkit-outer-spin-button,
        input[type=number]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type=number] { -moz-appearance: textfield; }
        
        .box { background: var(--white); padding: 25px; border-radius: var(--radius); box-shadow: var(--shadow); margin-bottom: 25px; border: 1px solid rgba(0,0,0,0.02); overflow: hidden; }
        .status-badge { display: inline-flex; align-items: center; gap: 6px; padding: 4px 12px; border-radius: 999px; font-size: 11px; font-weight: 700; text-transform: uppercase; }
        .status-badge.status-active { background: #e6fffa; color: var(--success); }
        .status-badge.status-trial { background: #fff6e6; color: #d4af37; }
        .status-badge.status-pending { background: #f1f2f6; color: #7f8c8d; }
        .status-badge.status-expired { background: #ffeaea; color: var(--danger); }
        .status-badge.status-cancelled { background: #f5f6fa; color: #636e72; }
        .status-badge.status-paused { background: #e8f0fe; color: #1a73e8; }
        .checkout-frame { width: 100%; min-height: 420px; border: 1px solid #f0f0f0; border-radius: 12px; background: #fff; }
        .checkout-loading { display: flex; align-items: center; gap: 10px; padding: 12px; background: #f8f9fb; border-radius: 12px; font-size: 12px; color: #666; }
        .checkout-loading .spinner { width: 24px; height: 24px; border-width: 3px; }
        .checkout-fallback-message {
            margin-top: 12px;
            padding: 12px 14px;
            border-radius: 10px;
            background: #fff7e6;
            border: 1px solid #f2d2a0;
            font-size: 12px;
            color: #7a4b00;
        }

        /* MENU LATERAL */
        .sidebar { width: 260px; background: var(--white); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 25px; flex-shrink: 0; height: 100vh; z-index: 1000; }
        .sidebar-header { margin-bottom: 30px; padding-left: 5px; }

        .nav-item { padding: 12px 15px; cursor: pointer; border-radius: 12px; margin-bottom: 5px; color: #666; font-size: 14px; font-weight: 500; display: flex; align-items: center; gap: 12px; transition: 0.2s; min-height: 48px; }
        .nav-item:hover { background: #f8f9fa; color: var(--dark); }
        .nav-item.active { background: #fff9e6; color: var(--primary); font-weight: 600; }
        .nav-item i { font-size: 22px; color: #999; display: flex; align-items: center; justify-content: center; width: 24px; height: 24px; }
        .nav-item.active i { color: var(--primary); }

        .main-content { flex: 1; overflow-y: auto; padding: 30px; background: #fafafa; position: relative; scroll-behavior: smooth; min-width: 0; overflow-x: hidden; }
        .section-view { display: none; animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1); }
        .section-view.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* KPIS - Estilo Limpo */
        .kpi-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .kpi-card { background: var(--white); padding: 20px; border-radius: 12px; border: 1px solid #f0f0f0; box-shadow: var(--shadow); display: flex; flex-direction: column; }
        .kpi-label { font-size: 11px; text-transform: uppercase; color: #999; font-weight: 700; margin-bottom: 5px; letter-spacing: 0.5px; }
        .kpi-value { font-size: 26px; color: var(--dark); font-weight: 700; }
        .kpi-sub { font-size: 12px; color: #bbb; margin-top: 5px; }

        .header-controls { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; flex-wrap: wrap; gap: 15px; }

        /* --- TABELA ROBUSTA (GERAL) --- */
        .table-responsive { width: 100%; max-width: 100%; overflow-x: auto; -webkit-overflow-scrolling: touch; padding-bottom: 5px; }
        .data-table { width: 100%; border-collapse: separate; border-spacing: 0; white-space: nowrap; margin-top: 0; }
        .data-table th { text-align: left; color: #888; font-size: 11px; text-transform: uppercase; padding: 16px; border-bottom: 2px solid #f0f0f0; font-weight: 700; background: white; vertical-align: middle; height: 50px; }
        .data-table td { padding: 16px; border-bottom: 1px solid #f8f9fa; vertical-align: middle; font-size: 13px; color: #555; background: white; height: 60px; }
        .col-checkbox { width: 50px; min-width: 50px; text-align: center !important; position: sticky; left: 0; background: white; z-index: 2; padding-left: 10px; padding-right: 10px; }
        .col-thumb { width: 60px; text-align: center !important; }
        .col-code { width: 120px; text-align: center !important; }
        .col-price { width: 120px; text-align: center !important; font-weight: 600; color: #444; }
        .col-qty { width: 80px; text-align: center !important; }
        .col-actions { width: 140px; min-width: 140px; text-align: center !important; }
        .col-category { width: 120px; min-width: 120px; text-align: left; }
        .data-table th:last-child, .data-table td:last-child { text-align: center; width: 140px; min-width: 140px; padding-right: 20px; }
        .data-table tr:hover td { background: #fbfbfb; }

        /* --- TABELA PREMIUM (LOTE) - ALINHAMENTO CORRIGIDO --- */
        .table-container-premium { background: transparent; box-shadow: none; border: none; }
        .table-premium { border-collapse: separate; border-spacing: 0 10px; width: 100%; }
        .table-premium thead th {
            background: transparent; color: #888; font-size: 11px; font-weight: 700; text-transform: uppercase;
            letter-spacing: 1px; padding: 0 15px 10px 15px; border: none;
        }
        .table-premium tbody tr {
            background: #ffffff; box-shadow: 0 2px 6px rgba(0,0,0,0.02); transition: all 0.2s ease; border-radius: 12px;
        }
        .table-premium tbody tr:hover {
            transform: translateY(-2px); box-shadow: 0 8px 20px rgba(212, 175, 55, 0.15); z-index: 10; position: relative;
        }
        .table-premium tbody td:first-child { border-top-left-radius: 12px; border-bottom-left-radius: 12px; }
        .table-premium tbody td:last-child { border-top-right-radius: 12px; border-bottom-right-radius: 12px; }
        .table-premium td { padding: 12px 15px; border: none; vertical-align: middle; }
        
        .input-premium {
            background: #f8f9fa; border: 1px solid transparent; border-radius: 8px;
            padding: 10px 12px; font-size: 13px; font-family: 'Poppins', sans-serif;
            color: #444; width: 100%; transition: 0.3s;
        }
        .input-premium:focus { background: #fff; border-color: var(--primary); box-shadow: 0 4px 15px rgba(212, 175, 55, 0.15); }
        .input-code { font-family: 'Courier New', monospace; font-weight: 700; letter-spacing: -0.5px; color: var(--dark); text-align: center; }
        .select-premium { background: #f8f9fa; border: 1px solid transparent; border-radius: 8px; padding: 10px; font-size: 13px; width: 100%; cursor: pointer; }

        /* REMESSAS LISTA */
        .remessas-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin-top: 20px; }
        .remessa-card { 
            background: var(--white); border-radius: 16px; padding: 25px; 
            box-shadow: var(--shadow); border: 1px solid rgba(0,0,0,0.02); 
            position: relative; transition: 0.3s; cursor: pointer; display: flex; flex-direction: column; justify-content: space-between; overflow: hidden;
        }
        .remessa-card:hover { transform: translateY(-5px); box-shadow: 0 12px 30px rgba(212,175,55,0.15); border-color: var(--primary); }
        .remessa-card::before { content:''; position: absolute; top: 0; left: 0; bottom: 0; width: 5px; background: var(--warning); }
        .remessa-card:has(.status-rascunho)::before { background: var(--warning); }
        .remessa-card:has(.status-ativo)::before { background: var(--success); }
        .remessa-card:has(.status-finalizado)::before { background: #b2bec3; }

        .remessa-status { position: absolute; top: 20px; right: 20px; font-size: 24px; }
        .status-rascunho { color: var(--warning); }
        .status-ativo { color: var(--success); }
        .status-finalizado { color: #b2bec3; }
        .badge-status-card { display: inline-block; padding: 4px 10px; border-radius: 20px; font-size: 11px; font-weight: 700; text-transform: uppercase; margin-bottom: 10px; }
        .bg-pendente { background: #fff9e6; color: #d4af37; }
        .bg-aprovado { background: #e6fffa; color: var(--success); }
        .bg-finalizado { background: #f1f2f6; color: #999; }
        .remessa-info { padding-left: 10px; }
        .remessa-info h4 { margin: 0 0 5px 0; font-size: 16px; color: var(--dark); font-weight: 700; }
        .remessa-info p { margin: 0; font-size: 12px; color: #888; }
        .remessa-footer { margin-top: 20px; padding-top: 15px; border-top: 1px solid #f5f5f5; display: flex; justify-content: space-between; align-items: center; font-size: 12px; font-weight: 600; color: var(--primary); }

        /* VIEW LOTE - FERRAMENTAS E KPIS */
        .lote-kpi-container { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; margin-bottom: 25px; }
        .lote-header-info { display: flex; align-items: center; gap: 20px; flex-wrap: wrap; }
        #barLoteActions { display: flex; flex-wrap: wrap; gap: 12px; align-items: center; justify-content: space-between; }
        #barLoteActions > div { min-width: 0; }
        .kpi-mini { background: white; padding: 15px; border-radius: 12px; border: 1px solid #eee; text-align: center; box-shadow: var(--shadow); }
        .kpi-mini label { font-size: 10px; text-transform: uppercase; color: #aaa; font-weight: 700; display: block; margin-bottom: 5px; }
        .kpi-mini span { font-size: 18px; font-weight: 700; color: var(--dark); }

        /* TOOLBAR BOTOES */
        .toolbar-lote { display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; background: white; padding: 10px; border-radius: 12px; box-shadow: var(--shadow); border: 1px solid #f0f0f0; justify-content: flex-end; }
        .btn-tool { 
            display: flex; align-items: center; justify-content: center; gap: 8px; 
            padding: 10px 18px; border: none; border-radius: 10px; font-size: 13px; font-weight: 600; 
            cursor: pointer; color: white; transition: 0.3s;
        }
        .btn-tool:hover { transform: translateY(-4px); box-shadow: 0 6px 15px rgba(0,0,0,0.15); }
        .btn-tool.scan { background: var(--dark); }
        .btn-tool.gold { background: var(--primary); color: white; }
        .btn-tool.approve { background: var(--success); }
        .btn-tool.delete { background: var(--danger); }

        .mobile-header { 
            display: none; justify-content: space-between; align-items: center; padding: 15px 20px; 
            background: var(--white); border-bottom: 1px solid var(--border);
            position: sticky; top: 0; z-index: 800;
        }
        
        .chart-container { position: relative; height: 350px; width: 100%; margin-top: 10px; }
        .chart-controls { display: flex; flex-direction: column; gap: 15px; margin-bottom: 15px; }
        .year-control { display: flex; align-items: center; justify-content: center; gap: 15px; font-weight: 600; font-size: 16px; }
        .btn-year { background: white; border: 1px solid var(--border); border-radius: 50%; width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.2s; }
        .btn-year:hover { background: var(--primary); color: white; border-color: var(--primary); }
        .month-list { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 10px; scrollbar-width: none; }
        .month-card { background: white; border: 1px solid var(--border); border-radius: 20px; padding: 6px 16px; text-align: center; font-size: 12px; font-weight: 600; color: #666; cursor: pointer; transition: 0.2s; white-space: nowrap; }
        .month-card.active { background: var(--primary); color: white; border-color: var(--primary); box-shadow: 0 4px 10px rgba(212, 175, 55, 0.25); }

        /* Padrão visual do overlay: cor, blur, opacidade, z-index e animação base */
        .modal-overlay { 
            display: none; position: fixed; inset: 0; width: 100%; height: 100%;
            background: var(--overlay-bg); z-index: var(--overlay-z);
            opacity: 0; transition: opacity 0.25s ease;
            backdrop-filter: blur(var(--overlay-blur));
        }
        .modal-overlay.open { display: flex; opacity: 1; animation: overlayFadeIn 0.25s ease; }
        .modal--center { justify-content: center; align-items: center; }
        .modal--side { justify-content: flex-end; align-items: stretch; }
        .modal--fullscreen { justify-content: center; align-items: center; }
        .modal-content {
            background: var(--white);
            padding: 35px;
            border-radius: 12px;
            width: 90%;
            max-width: 420px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        .modal-header { text-align: center; margin-bottom: 25px; }
        .modal-icon { width: 64px; height: 64px; border-radius: 50%; margin: 0 auto 15px; display: flex; align-items: center; justify-content: center; font-size: 32px; }
        .icon-danger { background: #fff5f5; color: var(--danger); }
        .icon-success { background: #e6fffa; color: var(--success); }
        .icon-info { background: #f3f0ff; color: var(--info); }
        .modal-title { margin: 0; color: var(--dark); font-size: 18px; font-weight: 600; }
        .modal-desc { font-size: 13px; color: #666; margin-top: 8px; line-height: 1.5; }
        .modal-actions { display: flex; gap: 12px; margin-top: 25px; }
        .modal-actions button { flex: 1; padding: 12px; }
        .modal-actions .btn { background: var(--primary); color: var(--white); }
        .modal-actions .btn:hover { background: var(--primary-hover); transform: translateY(-2px); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        @keyframes overlayFadeIn { from { opacity: 0; } to { opacity: 1; } }
        
        @media (max-width: 768px) {
            .sidebar { position: fixed; left: -280px; height: 100%; transition: 0.3s; box-shadow: 5px 0 30px rgba(0,0,0,0.1); }
            .sidebar.show { left: 0; }
            .mobile-header { display: flex; }
            .main-content { padding: 15px; }
            .kpi-grid { grid-template-columns: 1fr 1fr; gap: 10px; }
            .lote-kpi-container { grid-template-columns: 1fr 1fr; gap: 10px; }
            .toolbar-lote { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }
            .btn-tool { width: 100%; min-width: 0; font-size: 12px; padding: 10px; }
            .header-controls { flex-direction: column; align-items: stretch; gap: 15px; }
            .btn-group-responsive { display: grid !important; grid-template-columns: 1fr 1fr; gap: 10px; width: 100%; }
            #btnExcluirMassa { grid-column: span 2; }
            #btnIrCadastro { grid-column: span 2; }
            #barLoteActions { flex-direction: column; align-items: stretch; }
            #barLoteActions button { width: 100%; }
            .lote-header-info { gap: 12px; }
            .data-table { white-space: normal; }
            .data-table th,
            .data-table td { padding: 12px; }
            .table-premium.lotes-table { min-width: 100%; }
            .col-qty { min-width: 70px; }
        }

        @media (max-width: 480px) {
            .kpi-grid { grid-template-columns: 1fr; }
            .lote-kpi-container { grid-template-columns: 1fr; }
            .toolbar-lote { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

<div id="loadingOverlay">
    <div class="spinner"></div>
    <p style="margin-top: 15px; font-weight: 500; color: #888; font-size: 13px; letter-spacing: 0.5px;">CARREGANDO SISTEMA</p>
</div>

<div id="mobileOverlay" class="modal-overlay" data-modal-ignore="true" style="z-index: 900;"></div>

<aside class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <div style="display: flex; align-items: center; gap: 10px; font-size: 22px; font-weight: 700; color: var(--dark);">
            <i class="ph-fill ph-diamonds-four" style="color: var(--primary);"></i> Consignei
        </div>
        <div style="font-size: 12px; color: #999; font-weight: 400; margin-left: 36px; margin-top: 2px;">Gestão Inteligente</div>
    </div>
    
    <div class="nav-item active" data-target="dashboard"><i class="ph ph-squares-four"></i> Visão Geral</div>
    <div class="nav-item" data-target="gestao-remessas"><i class="ph ph-package"></i> Gestão de Remessas</div>
    <div class="nav-item" data-target="produtos"><i class="ph ph-diamond"></i> Inventário</div>
    <div class="nav-item" data-target="vendas"><i class="ph ph-shopping-bag"></i> Vendas</div>
    <div class="nav-item" data-target="categorias"><i class="ph ph-tag"></i> Categorias</div>
    <div class="nav-item" data-target="fornecedores"><i class="ph ph-users"></i> Fornecedores</div>
    <div class="nav-item" data-target="config"><i class="ph ph-gear"></i> Configurações</div>
    
    <div style="margin-top: auto; border-top: 1px solid #eee; padding-top: 20px;">
        <a href="#" id="btnLogout" class="nav-item" style="color: var(--danger); background: transparent;">
            <i class="ph ph-sign-out" style="color: var(--danger);"></i> Sair do Sistema
        </a>
    </div>
</aside>

<div style="flex: 1; display: flex; flex-direction: column; height: 100vh; overflow: hidden;">
    
    <div class="mobile-header">
        <div style="display: flex; align-items: center; gap: 8px; font-size: 18px; font-weight: 700; color: var(--dark);">
            <i class="ph-fill ph-diamonds-four" style="color: var(--primary);"></i> Consignei
        </div>
        <button class="btn-icon" id="mobileMenuBtn" style="color: #444;" onclick="document.getElementById('sidebar').classList.add('show'); document.getElementById('mobileOverlay').classList.add('open');">
            <i class="ph ph-list" style="font-size: 28px;"></i>
        </button>
    </div>

    <main class="main-content">
        
        <section id="dashboard" class="section-view active">
            <h2 style="font-weight: 600; color: var(--dark); margin-bottom: 25px;">Dashboard Financeiro</h2>
            <div class="kpi-grid">
                <div class="kpi-card">
                    <div class="kpi-label">Vendas no Mês</div>
                    <div class="kpi-value" id="kpiVendasCount">0</div>
                    <div class="kpi-sub">Peças vendidas</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">Custo Total</div>
                    <div class="kpi-value" id="kpiVendasCusto">R$ 0,00</div>
                    <div class="kpi-sub">Valor de reposição</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">Faturamento</div>
                    <div class="kpi-value" id="kpiVendasTotal">R$ 0,00</div>
                    <div class="kpi-sub">Entrada bruta</div>
                </div>
                <div class="kpi-card">
                    <div class="kpi-label">Lucro Líquido</div>
                    <div class="kpi-value" id="kpiVendasLucro">R$ 0,00</div>
                    <div class="kpi-sub">Dinheiro no bolso</div>
                </div>
            </div>
            <div class="box">
                <h3 style="font-size: 14px; text-transform: uppercase; color: #999; margin: 0 0 20px 0; font-weight: 700;">Performance de Vendas</h3>
                <div class="chart-controls">
                    <div class="year-control">
                        <button class="btn-year" id="btnAnoAnt"><i class="ph ph-caret-left"></i></button>
                        <span id="labelAno">2026</span>
                        <button class="btn-year" id="btnAnoProx"><i class="ph ph-caret-right"></i></button>
                    </div>
                    <div class="month-list" id="listaMeses"></div>
                </div>
                <div class="chart-container"><canvas id="chartVendas"></canvas></div>
            </div>
        </section>

        <section id="gestao-remessas" class="section-view">
            <div class="header-controls">
                <div>
                    <h2 style="font-weight: 600; margin:0;">Gestão de Remessas</h2>
                    <p style="font-size: 13px; color: #999; margin-top: 5px;">Controle de lotes consignados e acertos.</p>
                </div>
                <button class="btn btn-primary" data-action="abrir-modal-remessa">
                    <i class="ph ph-plus-circle" style="font-size: 18px;"></i> Novo Lote
                </button>
            </div>
            <div class="remessas-grid" id="listaRemessas">
                <div style="grid-column: 1/-1; text-align: center; padding: 50px; color: #999;">
                    <div class="spinner"></div>
                </div>
            </div>
        </section>

        <section id="view-lote" class="section-view">
            <div class="header-controls" style="align-items: center; border-bottom: 1px solid #eee; padding-bottom: 20px; margin-bottom: 25px;">
                <div class="lote-header-info" style="display:flex; align-items:center; gap:20px;">
                    <button class="btn-icon" onclick="document.querySelector('[data-target=\'gestao-remessas\']').click()" style="background:#fff; border:1px solid #eee; box-shadow: 0 2px 5px rgba(0,0,0,0.05);">
                        <i class="ph-bold ph-arrow-left"></i>
                    </button>
                    <div>
                        <h2 id="loteTitulo" style="font-weight: 700; margin:0; font-size:24px; color:var(--dark);">Lote #--</h2>
                        <div style="display:flex; align-items:center; gap:8px; margin-top:5px;">
                            <span id="loteStatusBadge" style="font-size:11px; background:#f0f0f0; padding:4px 12px; border-radius:20px; font-weight:700; text-transform:uppercase; letter-spacing:0.5px;">Carregando...</span>
                        </div>
                    </div>
                </div>
                <div id="loteToolbar" style="display:flex; gap:12px; flex-wrap: wrap; justify-content: flex-end;">
                    <button class="btn-tool delete" onclick="window.excluirLoteAtual()" title="Excluir Lote">
                        <i class="ph-bold ph-trash"></i> Excluir Lote
                    </button>
                    <button class="btn-tool scan" onclick="window.iniciarEscaneamentoIA()">
                        <i class="ph-bold ph-camera"></i> Scanear
                    </button>
                    <button class="btn-tool gold" onclick="window.adicionarItemManualLote()">
                        <i class="ph-bold ph-plus"></i> Novo Produto
                    </button>
                    <button class="btn-tool approve" id="btnAprovarLote">
                        <i class="ph-bold ph-check-circle"></i> Aprovar
                    </button>
                </div>
            </div>

            <div class="lote-kpi-container">
                <div class="kpi-mini">
                    <label>Itens</label><span id="loteQtd">0</span>
                </div>
                <div class="kpi-mini">
                    <label>Custo Total</label><span id="loteCusto">R$ 0,00</span>
                </div>
                <div class="kpi-mini">
                    <label>Venda Total</label><span id="loteVenda">R$ 0,00</span>
                </div>
                <div class="kpi-mini">
                    <label>Lucro Previsto</label><span id="loteLucro">R$ 0,00</span>
                </div>
            </div>

            <div id="barLoteActions" style="display:none; background:#2d3436; color:white; padding:15px; border-radius:12px; margin-bottom:20px; align-items:center; justify-content:space-between; box-shadow: 0 8px 20px rgba(0,0,0,0.2);">
                <div style="display:flex; align-items:center; gap:10px;">
                    <div style="background:var(--primary); width:30px; height:30px; border-radius:50%; display:flex; align-items:center; justify-content:center; color:white; font-weight:bold;" id="qtdSelLote">0</div>
                    <span style="font-size:14px; font-weight:500;">Itens selecionados</span>
                </div>
                <button onclick="window.excluirMassaLote()" class="btn" style="background:#ff7675; color:white; border:none; padding:8px 20px; border-radius:8px; font-size:13px;">
                    <i class="ph-bold ph-trash"></i> Excluir
                </button>
            </div>

            <div class="table-responsive table-container-premium">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th class="col-checkbox" style="text-align:center;">
                                <input type="checkbox" id="checkAllLote" onchange="window.toggleCheckAllLote(this)">
                            </th>
                            <th class="col-code">Código</th>
                            <th style="text-align:left;">Produto</th>
                            <th class="col-category">Categoria</th>
                            <th class="col-qty">Qtd</th>
                            <th class="col-price">Custo</th>
                            <th class="col-price">Venda</th>
                        </tr>
                    </thead>
                    <tbody id="listaItensLote">
                        <tr><td colspan="7" class="center" style="padding:50px;">Carregando itens...</td></tr>
                    </tbody>
                </table>
            </div>
        </section>

        <section id="produtos" class="section-view">
            <div class="header-controls">
                <h2 style="font-weight: 600; margin:0;">Inventário</h2>
                <div class="btn-group-responsive">
                    <button class="btn btn-danger" id="btnExcluirMassa" onclick="window.excluirSelecionados()" style="display: none;">
                        <i class="ph ph-trash"></i> Excluir (<span id="countSelecionados">0</span>)
                    </button>
                    <button class="btn btn-primary" id="btnIrCadastro">
                        <i class="ph ph-plus" style="font-size: 16px;"></i> Novo Produto
                    </button>
                </div>
            </div>
            <input type="file" id="cameraInput" accept="image/*" multiple style="display: none;" onchange="window.enviarImagemIA(this)">
            <div class="box">
                <div style="position: relative;">
                    <i class="ph ph-magnifying-glass" style="position: absolute; left: 12px; top: 12px; color: #999; font-size: 18px;"></i>
                    <input type="text" id="buscaProduto" placeholder="Buscar por nome, código ou categoria..." style="padding-left: 40px; margin-bottom: 20px; border-color: #eee; background: #fafafa;">
                </div>
                <div class="table-responsive">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th class="col-checkbox"><input type="checkbox" id="checkAll" onchange="window.toggleCheckAll(this)"></th>
                                <th>Foto</th><th>Cód</th><th>Produto</th><th>Preço</th><th>Qtd</th><th class="center">Ações</th>
                            </tr>
                        </thead>
                        <tbody id="listaProdutos"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="cadastro" class="section-view">
            <div class="header-controls">
                <button class="btn btn-secondary" onclick="document.querySelector('[data-target=\'produtos\']').click()"><i class="ph ph-arrow-left"></i> Voltar</button>
                <h2 id="formTitle" style="font-weight: 600; margin:0;">Cadastrar Nova Peça</h2>
            </div>
            <div class="box" style="max-width: 800px; margin: 0 auto;">
                <form id="formProduto">
                    <input type="hidden" name="id" id="prodId">
                    <div style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px; margin-bottom: 20px;">
                        <div><label style="font-size:12px; color:#999; font-weight:600; margin-bottom:5px; display:block;">Código (SKU)</label><input type="text" name="codigo_produto" id="prodCodigo" required></div>
                        <div><label style="font-size:12px; color:#999; font-weight:600; margin-bottom:5px; display:block;">Nome da Joia</label><input type="text" name="nome" id="prodNome" required></div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div><label style="font-size:12px; color:#999; font-weight:600; margin-bottom:5px; display:block;">Categoria</label><select name="categoria" id="prodCategoria" required><option value="">Carregando...</option></select></div>
                        <div><label style="font-size:12px; color:#999; font-weight:600; margin-bottom:5px; display:block;">Fornecedor</label><select name="fornecedor_id" id="prodFornecedor" required><option value="">Carregando...</option></select></div>
                    </div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div><label style="font-size:12px; color:#999; font-weight:600; margin-bottom:5px; display:block;">Qtd</label><input type="number" name="quantidade" id="prodQtd" value="1" required></div>
                        <div><label style="font-size:12px; color:#999; font-weight:600; margin-bottom:5px; display:block;">Custo (R$)</label><input type="number" step="0.01" name="preco_custo" id="prodCusto" required></div>
                        <div><label style="font-size:12px; color:#999; font-weight:600; margin-bottom:5px; display:block;">Markup (%)</label><input type="number" step="0.01" name="markup" id="prodMarkup" value="100"></div>
                    </div>
                    <div style="margin-bottom: 20px;"><label style="font-size:12px; color:#999; font-weight:600; margin-bottom:5px; display:block;">Preço Final</label><input type="number" step="0.01" name="preco" id="prodPreco" style="background: #e6fffa; border-color: var(--success); font-weight: bold; color: var(--success); font-size: 16px;"></div>
                    <div style="margin-bottom: 30px;"><label style="font-size:12px; color:#999; font-weight:600; margin-bottom:5px; display:block;">Foto do Produto</label><input type="file" name="imagem" id="prodImg" accept="image/*" style="padding: 10px; border: 1px dashed #ccc;"></div>
                    <div style="display: flex; gap: 15px;">
                        <button type="submit" class="btn btn-primary" style="flex: 1; padding: 14px;">Salvar Produto</button>
                        <button type="button" id="btnCancelarEdicao" class="btn btn-secondary" style="display:none;">Cancelar</button>
                    </div>
                </form>
            </div>
        </section>
        
        <section id="vendas" class="section-view">
            <h2 style="font-weight: 600; margin-bottom: 25px;">Histórico de Vendas</h2>
            <div class="box">
                <div class="table-responsive">
                    <table class="data-table">
                        <thead><tr><th>Data</th><th>Produto</th><th>Venda (R$)</th><th>Lucro (R$)</th><th class="center">Ações</th></tr></thead>
                        <tbody id="listaVendas"></tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="categorias" class="section-view">
            <div class="header-controls">
                <h2 style="font-weight: 600; margin:0;">Categorias</h2>
                <button class="btn btn-primary" id="btnAddCat"><i class="ph ph-plus"></i> Nova Categoria</button>
            </div>
            <div class="box">
                <div class="table-responsive">
                    <table class="data-table"><thead><tr><th>Nome</th><th class="center">Ações</th></tr></thead><tbody id="listaCategorias"></tbody></table>
                </div>
            </div>
        </section>

        <section id="fornecedores" class="section-view">
            <div class="header-controls">
                <h2 style="font-weight: 600; margin:0;">Fornecedores</h2>
                <button class="btn btn-primary" id="btnAddForn"><i class="ph ph-plus"></i> Novo Fornecedor</button>
            </div>
            <div class="box">
                <div class="table-responsive">
                    <table class="data-table"><thead><tr><th>Empresa/Nome</th><th>Contato</th><th class="center">Ações</th></tr></thead><tbody id="listaFornecedores"></tbody></table>
                </div>
            </div>
        </section>

        <section id="config" class="section-view">
            <h2 style="font-weight: 600; margin-bottom: 25px;">Configurações</h2>
            <form id="formConfig">
            <div class="box">
                    <div style="margin-bottom: 20px;"><label style="font-size:12px; color:#999; font-weight:600;">Nome da Loja</label><input type="text" id="cfgNomeLoja"></div>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div>
                            <label style="font-size:12px; color:#999; font-weight:600;">Nome do responsável</label>
                            <input type="text" id="cfgPayerFirstName" placeholder="Ex: Maria">
                        </div>
                        <div>
                            <label style="font-size:12px; color:#999; font-weight:600;">Sobrenome do responsável</label>
                            <input type="text" id="cfgPayerLastName" placeholder="Ex: Silva">
                        </div>
                    </div>
                    <div style="margin-bottom: 20px;">
                        <label style="font-size:12px; color:#999; font-weight:600;">Slug da Vitrine (link)</label>
                        <div style="display:flex; gap:10px; align-items:center;">
                            <input type="text" id="cfgSlug" placeholder="ex: minha-loja" style="flex:1;">
                            <button type="button" class="btn btn-secondary" id="btnGerarSlug" style="height:45px; padding: 0 14px;">
                                Gerar do Nome
                            </button>
                        </div>
                        <small style="display:block; margin-top:8px; color:#999; font-size:12px; line-height:1.3;">
                            Apenas letras minúsculas, números e hífen. Ex: <strong>minha-loja</strong>
                        </small>
                    </div>

                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;"><div><label style="font-size:12px; color:#999; font-weight:600;">Vendedor (@)</label><input type="text" id="cfgVendedor" placeholder="@seu.nome"></div><div><label style="font-size:12px; color:#999; font-weight:600;">Instagram</label><input type="text" id="cfgInstagram" placeholder="@loja"></div></div>
                    <div style="margin-bottom: 20px;"><label style="font-size:12px; color:#999; font-weight:600;">WhatsApp</label><input type="text" id="cfgWhats" placeholder="Ex: 5511999999999"></div>
                    <div style="margin-bottom: 30px;">
                        <label style="display:block; margin-bottom: 10px; font-size:12px; color:#999; font-weight:600;">Tema da Vitrine</label>
                        <div class="theme-options">
                            <div class="theme-opt" data-theme="rose" style="background: #e91e63;"></div>
                            <div class="theme-opt" data-theme="dark" style="background: #222;"></div>
                            <div class="theme-opt" data-theme="marble" style="background: #f0f0f0;"></div>
                            <div class="theme-opt" data-theme="gold" style="background: #d4af37;"></div>
                        </div>
                    </div>
            </div>
            <div class="box" style="margin-top: 25px;">
                <h3 style="font-size: 15px; margin-top: 0; color:#444;">Aparência da Vitrine</h3>
                <div style="margin-bottom: 20px;">
                    <label style="display:block; margin-bottom: 10px; font-size:12px; color:#999; font-weight:600;">Mensagem da Barra Superior</label>
                    <input type="text" id="cfgBannerAviso" placeholder="Ex: Frete Grátis acima de R$ 200">
                    <small style="display:block; margin-top:8px; color:#999; font-size:12px; line-height:1.3;">
                        Esta mensagem aparece no topo da vitrine.
                    </small>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div>
                        <label style="display:block; margin-bottom: 10px; font-size:12px; color:#999; font-weight:600;">Cor de Fundo</label>
                        <input type="color" id="cfgCorFundo" value="#ffffff" style="height: 45px; padding: 6px;">
                    </div>
                    <div>
                        <label style="display:block; margin-bottom: 10px; font-size:12px; color:#999; font-weight:600;">Fonte / Tipografia</label>
                        <select id="cfgEstiloFonte">
                            <option value="classico">Clássica (Serifa - Playfair Display)</option>
                            <option value="moderno">Moderna (Sans - Montserrat/Poppins)</option>
                            <option value="romantico">Romântica (Cursiva/Serifa - Dancing Script)</option>
                        </select>
                    </div>
                </div>
                <div style="margin-bottom: 30px;">
                    <label style="display:block; margin-bottom: 10px; font-size:12px; color:#999; font-weight:600;">Textura do Fundo (CSS)</label>
                    <select id="cfgTexturaFundo">
                        <option value="liso">Liso (Apenas cor)</option>
                        <option value="marble">Mármore</option>
                        <option value="silk">Seda/Cetim</option>
                        <option value="concrete">Concreto</option>
                        <option value="luxury">Gradiente Luxo</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary">Salvar Alterações</button>
            </div>
            </form>
            <div class="box" style="margin-top: 25px; background: #f9f9f9;"><h3 style="font-size: 14px; margin-top:0; color:#444;">Link da Vitrine</h3><div style="display: flex; gap: 10px;"><input type="text" id="linkVitrine" readonly style="background: white;"><button class="btn btn-primary" id="btnCopiarLink">Copiar</button><a class="btn btn-secondary" id="btnAbrirLink" href="#" target="_blank" rel="noopener">Abrir</a></div></div>
            <div class="box" style="margin-top: 25px;">
                <div style="display:flex; align-items:center; justify-content: space-between; flex-wrap: wrap; gap: 12px;">
                    <div>
                        <h3 style="font-size: 16px; margin:0; color:#444;">Assinatura</h3>
                        <p id="assinaturaPlanHint" style="margin:6px 0 0; font-size: 12px; color:#777;">Plano mensal R$ 21,90.</p>
                    </div>
                    <span id="assinaturaStatusBadge" class="status-badge status-pending">Pendente</span>
                </div>
                <div style="margin-top: 18px; display: grid; grid-template-columns: 1fr 1fr; gap: 18px;">
                    <div>
                        <label style="font-size:12px; color:#999; font-weight:600; text-transform: uppercase;">Status atual</label>
                        <div id="assinaturaStatusTexto" style="font-size: 14px; font-weight: 600; color: #444; margin-top: 6px;">Pendente</div>
                    </div>
                    <div>
                        <label style="font-size:12px; color:#999; font-weight:600; text-transform: uppercase;">Renovação</label>
                        <div id="assinaturaStatusData" style="font-size: 13px; color: #666; margin-top: 6px;">Aguardando ativação</div>
                    </div>
                </div>
                <div style="display:flex; align-items:center; justify-content: space-between; gap: 12px; flex-wrap: wrap; margin-top: 20px;">
                    <div style="font-size: 12px; color:#888; display:flex; align-items:center; gap:6px;">
                        <i class="ph ph-shield-check"></i> Pagamento seguro com gateway de pagamento.
                    </div>
                    <button class="btn btn-primary" id="btnAssinaturaPrincipal" data-modal-open="modalPagamento"><i class="ph ph-credit-card"></i> Ativar assinatura</button>
                </div>
            </div>
            <div class="box" style="margin-top: 40px; border: 1px solid #ffcccc; background: #fff5f5;">
                <h3 style="color: #d32f2f; margin-top: 0; display: flex; align-items: center; gap: 10px; font-size: 16px;"><i class="ph-fill ph-warning" style="font-size: 22px;"></i> Zona de Perigo</h3>
                <p style="font-size: 13px; color: #666; line-height: 1.5; margin-bottom: 20px;">Ao excluir sua conta, todos os seus <strong>produtos, vendas, fotos e configurações</strong> serão apagados permanentemente. Esta ação é irreversível.</p>
                <button id="btnAbrirExcluirConta" class="btn btn-danger" style="font-size: 13px;">Excluir Minha Conta Permanentemente</button>
            </div>
        </section>
    </main>
</div>

<div id="modalDevolucao" class="modal-overlay modal--center" role="dialog" aria-modal="true" aria-labelledby="modalDevolucaoTitle" aria-describedby="modalDevolucaoDesc"><div class="modal-content"><div class="modal-header"><div class="modal-icon icon-danger"><i class="ph ph-arrow-u-up-left"></i></div><h3 class="modal-title" id="modalDevolucaoTitle">Devolução Avulsa</h3><p class="modal-desc" id="modalDevolucaoDesc">Retire um item do estoque manualmente.</p></div><label style="font-size:11px; color:#999; font-weight:700; text-transform:uppercase; margin-bottom:5px; display:block;">Produto</label><select id="selectDevolucao" style="margin-bottom: 20px;"></select><label style="font-size:11px; color:#999; font-weight:700; text-transform:uppercase; margin-bottom:5px; display:block;">Quantidade</label><input type="number" id="qtdDevolucao" placeholder="0" style="margin-bottom: 10px;"><div class="modal-actions"><button class="btn btn-secondary" data-modal-close="modalDevolucao">Cancelar</button><button class="btn btn-danger" id="btnConfirmarDevolucao">Confirmar</button></div></div></div>
<div id="modalEditarVenda" class="modal-overlay modal--center" role="dialog" aria-modal="true" aria-labelledby="modalEditarVendaTitle" aria-describedby="modalEditarVendaDesc"><div class="modal-content"><div class="modal-header"><div class="modal-icon icon-info"><i class="ph-fill ph-pencil-simple"></i></div><h3 class="modal-title" id="modalEditarVendaTitle">Editar Venda</h3><p class="modal-desc" id="modalEditarVendaDesc">Atualize as informações da venda selecionada.</p></div><input type="hidden" id="editVendaId"><label style="font-size:11px; color:#999; font-weight:700; text-transform:uppercase; margin-bottom:5px; display:block;">Data</label><input type="date" id="editVendaData" style="margin-bottom: 15px;"><label style="font-size:11px; color:#999; font-weight:700; text-transform:uppercase; margin-bottom:5px; display:block;">Valor (R$)</label><input type="number" step="0.01" id="editVendaPreco" style="margin-bottom: 20px;"><div class="modal-actions"><button class="btn btn-secondary" data-modal-close="modalEditarVenda">Cancelar</button><button class="btn btn-primary" id="btnSalvarEdicaoVenda">Salvar</button></div></div></div>
<div id="modalConfirmarVenda" class="modal-overlay modal--center" role="dialog" aria-modal="true" aria-labelledby="modalConfirmarVendaTitle" aria-describedby="modalConfirmarVendaDesc"><div class="modal-content"><div class="modal-header"><div class="modal-icon icon-success"><i class="ph-fill ph-currency-dollar"></i></div><h3 class="modal-title" id="modalConfirmarVendaTitle">Confirmar Venda</h3><p class="modal-desc" id="modalConfirmarVendaDesc">Registrar saída e entrada de caixa?</p></div><div class="modal-actions"><button class="btn btn-secondary" data-modal-close="modalConfirmarVenda">Cancelar</button><button class="btn btn-primary" id="btnRealizarVenda">Confirmar</button></div></div></div>
<div id="modalGenerico" class="modal-overlay modal--center" role="dialog" aria-modal="true" aria-labelledby="modalGenericoTitle" aria-describedby="modalGenericoDesc"><div class="modal-content"><div class="modal-header"><div class="modal-icon icon-info"><i class="ph-fill ph-pencil-simple"></i></div><h3 class="modal-title" id="modalGenericoTitle">Adicionar</h3><p class="modal-desc" id="modalGenericoDesc">Preencha os dados para salvar o item.</p></div><input type="hidden" id="modalParentId"><input type="hidden" id="modalEditId"><input type="text" id="modalInput" placeholder="Nome..." style="margin-bottom: 15px;"><input type="text" id="modalInputExtra" placeholder="Contato..." style="margin-bottom: 10px; display:none;"><div class="modal-actions"><button class="btn btn-secondary" data-modal-close="modalGenerico">Cancelar</button><button class="btn btn-primary" id="btnModalSalvar">Salvar</button></div></div></div>
<div id="modalConfirmacao" class="modal-overlay modal--center" role="dialog" aria-modal="true" aria-labelledby="modalConfirmacaoTitle" aria-describedby="modalConfirmacaoDesc"><div class="modal-content"><div class="modal-header"><div class="modal-icon icon-danger"><i class="ph-fill ph-trash"></i></div><h3 class="modal-title" id="modalConfirmacaoTitle" style="color: var(--danger);">Excluir?</h3><p class="modal-desc" id="modalConfirmacaoDesc">Essa ação não pode ser desfeita.</p></div><div class="modal-actions"><button class="btn btn-secondary" data-modal-close="modalConfirmacao">Cancelar</button><button class="btn btn-danger" id="btnConfirmarExclusao">Sim, Excluir</button></div></div></div>
<div id="modalSucesso" class="modal-overlay modal--center" role="dialog" aria-modal="true" aria-labelledby="modalSucessoTitle" aria-describedby="msgSucesso"><div class="modal-content" style="text-align: center;"><div class="modal-icon icon-success" style="margin-bottom:15px;"><i class="ph-fill ph-check-circle"></i></div><h3 class="modal-title" id="modalSucessoTitle">Sucesso!</h3><p class="modal-desc" id="msgSucesso" style="margin-bottom: 25px;">Ação realizada.</p><button class="btn btn-primary" data-modal-close="modalSucesso" style="width: 100%; padding: 12px;">OK</button></div></div>
<div id="modalExcluirConta" class="modal-overlay modal--center" role="dialog" aria-modal="true" aria-labelledby="modalExcluirContaTitle" aria-describedby="modalExcluirContaDesc"><div class="modal-content"><div class="modal-header"><div class="modal-icon icon-danger"><i class="ph-fill ph-warning-octagon"></i></div><h3 class="modal-title" id="modalExcluirContaTitle" style="color: var(--danger);">Excluir Conta?</h3><p class="modal-desc" id="modalExcluirContaDesc">Digite <strong>EXCLUIR</strong> para confirmar.</p></div><input type="text" id="inputConfirmaExclusao" placeholder="EXCLUIR" style="text-align: center; border: 2px solid #ffcccc; margin-bottom: 10px; text-transform: uppercase; font-weight: bold; letter-spacing: 1px;"><div class="modal-actions"><button class="btn btn-secondary" data-modal-close="modalExcluirConta">Cancelar</button><button class="btn btn-danger" id="btnFinalizarExclusao">Apagar Tudo</button></div></div></div>
<div id="modalNovaRemessa" class="modal-overlay modal--center" role="dialog" aria-modal="true" aria-labelledby="modalNovaRemessaTitle" aria-describedby="modalNovaRemessaDesc"><div class="modal-content"><div class="modal-header"><div class="modal-icon icon-info"><i class="ph ph-package"></i></div><h3 class="modal-title" id="modalNovaRemessaTitle">Nova Remessa</h3><p class="modal-desc" id="modalNovaRemessaDesc">Inicie um novo lote de consignação.</p></div><label style="font-size:11px; font-weight:700; color:#999; text-transform:uppercase; display:block; margin-bottom:5px;">Fornecedor</label><select id="remessaFornecedor" style="margin-bottom: 20px;"></select><label style="font-size:11px; font-weight:700; color:#999; text-transform:uppercase; display:block; margin-bottom:5px;">Observação</label><input type="text" id="remessaObs" placeholder="Ex: Coleção Verão..." style="margin-bottom: 20px;"><div class="modal-actions"><button class="btn btn-secondary" data-modal-close="modalNovaRemessa">Cancelar</button><button class="btn btn-primary" id="btnConfirmarNovaRemessa">Criar Lote</button></div></div></div>
<div id="modalPagamento" class="modal-overlay modal--center" role="dialog" aria-modal="true" aria-labelledby="modalPagamentoTitle" aria-describedby="modalPagamentoDesc">
    <div class="modal-content">
        <div class="modal-header">
            <div class="modal-icon icon-info"><i class="ph ph-credit-card"></i></div>
            <h3 class="modal-title" id="modalPagamentoTitle">Pagamento da Assinatura</h3>
            <p class="modal-desc" id="modalPagamentoDesc">Você será redirecionado para concluir o pagamento.</p>
        </div>
        <div style="display:flex; align-items:center; justify-content: space-between; gap: 10px; flex-wrap: wrap; margin-bottom: 18px;">
            <div id="assinaturaModalPrice" style="font-size: 13px; color:#444; font-weight: 600;">R$ 21,90 / mês</div>
            <div id="assinaturaModalTrial" style="font-size: 12px; color:#777;"></div>
        </div>
        <p id="checkoutNotice" style="display: none; font-size: 12px; color:#666; margin-top: 12px;"></p>
        <div class="modal-actions" style="margin-top: 20px;">
            <button class="btn btn-secondary" data-modal-close="modalPagamento">Fechar</button>
            <button class="btn btn-primary" id="btnContinuarCheckout">Continuar</button>
        </div>
    </div>
</div>

<script src="js/modal.js"></script>
<script>
function abrirModalExcluirConta() { document.getElementById('inputConfirmaExclusao').value = ''; openModal('modalExcluirConta'); }
function fecharModalExcluirConta() { closeModal('modalExcluirConta'); }
async function executarExclusaoDefinitiva() {
    const input = document.getElementById('inputConfirmaExclusao').value.trim().toUpperCase();
    const btn = document.getElementById('btnFinalizarExclusao');
    if (input !== "EXCLUIR") {
        Swal.fire({ icon: 'error', title: 'Atenção', text: 'Digite EXCLUIR corretamente.' });
        return;
    }
    btn.innerText = "Excluindo..."; btn.disabled = true;
    try {
        const response = await fetch('../api/excluir_conta.php', { method: 'POST' });
        const result = await response.json();
        if (result.success) {
            fecharModalExcluirConta();
            document.getElementById('msgSucesso').innerText = "Conta removida com sucesso!";
            openModal('modalSucesso');
            setTimeout(() => { window.location.href = "/"; }, 2000);
        } else {
            Swal.fire({ icon: 'error', title: 'Erro', text: result.error || 'Erro ao excluir.' });
            btn.innerText = "Apagar Tudo"; btn.disabled = false;
        }
    } catch (error) {
        Swal.fire({ icon: 'error', title: 'Erro', text: 'Erro de conexão.' });
        btn.innerText = "Apagar Tudo"; btn.disabled = false;
    }
}

document.getElementById('btnAbrirExcluirConta').addEventListener('click', abrirModalExcluirConta);
document.getElementById('btnFinalizarExclusao').addEventListener('click', executarExclusaoDefinitiva);
</script>

<script src="dashboard.js"></script>
</body>
</html>
